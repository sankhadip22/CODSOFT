import random
try:
    import pyperclip
    CLIPBOARD_AVAILABLE = True
except ImportError:
    CLIPBOARD_AVAILABLE = False

import tkinter as tk
from tkinter import messagebox
from tkinter.ttk import Combobox, Radiobutton, Style, Frame, Label, Entry, Button

# ---------------- Password Generator Logic ---------------- #

def generate_password():
    length = length_var.get()

    lower = "abcdefghijklmnopqrstuvwxyz"
    upper = "ABCDEFGHIJKLMNOPQRSTUVWXYZ"
    digits = "0123456789"
    symbols = "!@#$%^&*()"

    if strength_var.get() == 1:  # Low
        chars = lower
    elif strength_var.get() == 2:  # Medium
        chars = lower + upper
    elif strength_var.get() == 3:  # Strong
        chars = lower + upper + digits + symbols
    else:
        return ""

    # Guarantee at least one of each category for strong passwords
    password = []
    if strength_var.get() == 3:
        password = [
            random.choice(lower),
            random.choice(upper),
            random.choice(digits),
            random.choice(symbols),
        ]
        length -= 4

    password += [random.choice(chars) for _ in range(length)]
    random.shuffle(password)
    return "".join(password)

def generate():
    password = generate_password()
    entry.delete(0, tk.END)
    entry.insert(0, password)

    # Show password strength
    if strength_var.get() == 1:
        strength_label.config(text="Weak Password", foreground="red")
    elif strength_var.get() == 2:
        strength_label.config(text="Medium Password", foreground="orange")
    elif strength_var.get() == 3:
        strength_label.config(text="Strong Password", foreground="green")

def copy1():
    random_password = entry.get()
    if not random_password:
        messagebox.showwarning("Warning", "No password to copy!")
        return
    
    if CLIPBOARD_AVAILABLE:
        pyperclip.copy(random_password)
        messagebox.showinfo("Copied", "Password copied to clipboard!")
    else:
        messagebox.showerror("Error", "pyperclip not installed.\nRun:\n\npip install pyperclip")

# ---------------- UI Setup ---------------- #

root = tk.Tk()
strength_var = tk.IntVar()
length_var = tk.IntVar()

root.title("üîê Modern Password Generator")
root.geometry("500x250")
root.resizable(False, False)
root.configure(bg="#f0f4f8")

# Styling
style = Style()
style.configure("TButton", font=("Segoe UI", 10, "bold"), padding=6)
style.configure("TLabel", font=("Segoe UI", 11), background="#f0f4f8")
style.configure("TRadiobutton", background="#f0f4f8", font=("Segoe UI", 10))

# Frames
top_frame = Frame(root, padding=15)
top_frame.pack(fill="x")

mid_frame = Frame(root, padding=15)
mid_frame.pack(fill="x")

bottom_frame = Frame(root, padding=15)
bottom_frame.pack(fill="x")

# Password Entry
Label(top_frame, text="Generated Password:").grid(row=0, column=0, sticky="w", padx=5, pady=5)
entry = Entry(top_frame, width=35, font=("Consolas", 12))
entry.grid(row=0, column=1, padx=5)
Button(top_frame, text="Copy", command=copy1).grid(row=0, column=2, padx=5)

# Length Selection
Label(mid_frame, text="Password Length:").grid(row=0, column=0, sticky="w", padx=5, pady=5)
combo = Combobox(mid_frame, textvariable=length_var, width=5, font=("Segoe UI", 10))
combo['values'] = tuple(range(8, 33))
combo.current(0)
combo.grid(row=0, column=1, padx=5)

# Strength Radio Buttons
Label(mid_frame, text="Strength:").grid(row=1, column=0, sticky="w", padx=5, pady=5)
Radiobutton(mid_frame, text="Low", variable=strength_var, value=1).grid(row=1, column=1, padx=5)
Radiobutton(mid_frame, text="Medium", variable=strength_var, value=2).grid(row=1, column=2, padx=5)
Radiobutton(mid_frame, text="Strong", variable=strength_var, value=3).grid(row=1, column=3, padx=5)

# Strength Indicator
strength_label = Label(mid_frame, text="", font=("Segoe UI", 10, "bold"))
strength_label.grid(row=2, column=0, columnspan=4, pady=10)

# Generate Button
Button(bottom_frame, text="‚ú® Generate Password", command=generate).pack()

root.mainloop()
